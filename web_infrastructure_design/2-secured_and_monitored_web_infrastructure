
img 
https://imgur.com/EgqCFVA



Diagram:

```
                        +-----------+
                        |   User    |
                        +-----+-----+
                              |
                              |
                              |
                              v
                      +-------+-------+
                      |   Load Balancer  |
                      |   (HAProxy)     |
                      +-------+-------+
                              |
                              |
           +------------+-----+-----+-------------+
           |            |           |             |
           v            v           v             v
   +-------+-------+  +-----+   +-----+   +-------+-------+
   |   Firewall 1  |  | Firewall 2 | Firewall 3 | 
   +-------+-------+  +-----+   +-----+   +-------+-------+
           |                |            |
           v                v            v
  +---------+---------+ +---------+ +---------+ 
  |   Server 1        | |   Server 2 | |   Server 3 |
  |   (Application)   | |   (Application) |   (Application) |
  |                   | |            |             |
  |   +-----------+   | |   +-----------+   |   +-----------+
  |   |   Nginx   |   | |   |   Nginx   |   |   |   Nginx   |
  |   +-----------+   | |   +-----------+   |   +-----------+
  +---------+---------+ +---------+ +---------+ 
            |                |            |
            |                |            |
            v                v            v
      +------+------+   +------+------+   +------+
      | Database 1  |   | Database 2  |   | Database 3  |
      | (MySQL)     |   | (MySQL)     |   | (MySQL)     |
      |              |   |              |   |              |
      +--------------+   +--------------+   +--------------+
```

Explanation:

This enhanced web infrastructure incorporates the following additional components:

1. Firewalls: Three firewalls are added to the infrastructure to provide enhanced security. Firewalls act as a barrier between the public internet and the servers, allowing administrators to control and monitor incoming and outgoing network traffic. They help prevent unauthorized access, mitigate potential threats, and enforce security policies.

2. SSL Certificate: An SSL certificate is added to enable secure communication over HTTPS for the domain www.foobar.com. HTTPS encrypts the data transmitted between the user's browser and the web server, ensuring confidentiality, integrity, and authentication. It protects sensitive user information from interception and tampering.

3. Monitoring Clients: Three monitoring clients, such as data collectors for Sumo Logic or other monitoring services, are included. These clients collect and send data about the infrastructure's performance, availability, and health to a centralized monitoring system. Monitoring helps identify issues, track metrics, detect anomalies, and facilitate proactive troubleshooting and optimization.

Specifics of the infrastructure:

- Addition of Firewalls: Firewalls are added to reinforce security measures by filtering and controlling network traffic, blocking unauthorized access, and preventing potential attacks on the infrastructure.

- Use of SSL Certificate: SSL is implemented to secure the communication between users and the web server. It ensures that sensitive data, such as login credentials and personal information, is encrypted and protected from unauthorized access.

- Monitoring for Performance: Monitoring tools collect data from the infrastructure, including server metrics, application logs, and network activity. This data helps administrators analyze the system's performance, identify bottlenecks, and make informed decisions for optimization and troubleshooting.

- Data Collection in Monitoring: Monitoring tools typically employ agents or data collectors installed on the servers. These agents collect various metrics, logs, and events and transmit them to a centralized monitoring system for analysis and visualization.

- Monitoring Web Server QPS: To monitor the web server's Query Per Second (QPS), administrators can track metrics such as request count or throughput over a specific time period. This can be done by configuring the monitoring tool to collect and analyze the relevant data from the web server logs or by integrating with the server's performance monitoring APIs.

Issues with the infrastructure:

1. Termination of SSL at the Load Balancer: Terminating SSL at the load balancer level may pose an issue as it introduces a potential point of vulnerability. The decrypted traffic between the load balancer and the application servers is susceptible to interception, compromising the security of the data transmitted within the infrastructure.

2. Single MySQL Server Accepting Writes: Having only one MySQL server capable of accepting writes can be problematic. If this server fails, it would result in a single point of failure, causing potential data loss and service disruption. A redundant and highly available database setup, such as a primary-replica cluster or a distributed database system, is recommended for improved resilience.

3. Servers with the Same Components: Having servers with identical components (database, web server, and application server) can introduce a problem in terms of scalability and fault tolerance. If all servers have the same components, a failure or performance issue in one component (e.g., web server) can impact all servers simultaneously. It is advisable to distribute the workload across multiple servers with diversified roles to achieve better fault isolation and scalability.